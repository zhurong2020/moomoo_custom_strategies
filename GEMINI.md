# Gemini 在此项目的行为准则

## 1. 核心项目目标 (Core Project Objective)

本项目的核心目标是为 Moomoo 桌面客户端的量化功能开发和维护一系列**简单、独立、稳定**的自定义策略（`.quant` 文件）。

**关键约束：** 策略文件的复杂度**必须**保持在较低水平。所有高级功能，如24/7监控、实时通知、复杂的仓位/资金管理、本地文件记录等，都将由一个**外部应用**通过 Moomoo 的 OpenAPI (OpenD) 实现。你在本项目中的任务是**辅助开发和优化客户端内嵌的策略**，而不是构建一个独立的、功能完备的交易系统。

## 2. Moomoo API 使用协议 (Moomoo API Usage Protocol)

当你需要查询 Moomoo 量化策略中可用的 API 时，必须遵循以下步骤：

1.  **优先查阅本地文档：** 首先，你必须在项目 `docs/` 目录下查阅以下两个文件：
    *   `Moomoo量化功能中常用的API函数及其用法.txt`
    *   `Moomoo量化策略框架具体说明.txt`

2.  **明确告知并询问：** 如果在上述文件中找不到所需 API 的信息，你**必须**停止操作，并向我明确提出问题，例如：“我在本地API文档中没有找到关于 `[API名称]` 的信息，您能提供一下它的用法吗？” **严禁**在未查询或未得到明确答复的情况下，臆测或使用任何未在文档中定义的 API。

## 3. `strategies/` 目录开发规则

1.  **策略独立性：** `strategies/` 目录下的每一个子目录（如 `strategy_v1`, `strategy_v2`）都代表一个完全独立的策略。它们之间不应有任何代码依赖。
2.  **README 必备：** 每个策略的子目录都**必须**包含一个 `readme.md` 文件。当你创建一个新的策略目录或对现有策略进行重大修改时，需要确保 `readme.md` 文件存在并得到更新。`readme.md` 应至少说明：
    *   策略的核心思想和逻辑。
    *   关键的可配置参数及其作用。
3.  **`.quant` 文件简洁性要求：** 策略文件本身应保持简洁，专注于交易逻辑。**严禁**在 `.quant` 文件中添加以下功能：
    *   任何形式的文件I/O（如写入日志、交易记录到本地文件）。
    *   任何外部网络请求或通知（如发送邮件、调用Webhook）。
    *   复杂的、跨周期的状态管理（这些由外部App负责）。

## 4. 通用编码与风格指南

1.  **语言与规范：** 所有 Python 代码必须严格遵循 **PEP 8** 编码规范。
2.  **命名约定：**
    *   变量和函数名使用蛇形命名法 (e.g., `grid_price`, `calculate_profit`)。
    *   类名使用驼峰命名法 (e.g., `Strategy`, `OrderManager`)。
    *   命名必须简洁且能清晰地表达其意图。
3.  **注释：**
    *   只在必要时添加注释，优先编写自解释的代码。
    *   注释的重点是解释“**为什么**”这样实现，而不是“**做什么**”。
4.  **变更日志：** 在对任何策略文件进行有意义的功能性修改后，都需要在 `docs/changelog.md` 文件中追加一条简明的变更记录。

## 5. 工作流与提交

1.  **提交信息：** 所有 Git 提交信息都应遵循 `docs/commit_convention.md` 文件中定义的规范。
2.  **原子性提交：** 每次提交应集中于一个单一的功能或修复，保持提交的原子性。
